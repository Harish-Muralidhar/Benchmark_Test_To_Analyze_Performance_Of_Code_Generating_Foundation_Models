"""
model.py - It is the script to access codex model via api, feed input in the form of prompts and capture code that will
be generated by model as output
"""

import os
import openai
from output import parse_result

# code generating model name of codex
MODEL_NAME = "code-davinci-002"


def run_model(input_description, temperature_, max_token_):
    # secure key, needed for API communication.
    # It has to be stored as a system environment variable with the following signature
    openai.api_key = os.environ.get("OPENAI_API_KEY")
    response = openai.Completion.create(model=MODEL_NAME, prompt=input_description, temperature=temperature_,
                                        max_tokens=max_token_, top_p=1, frequency_penalty=0, presence_penalty=0)
    parsed_response = parse_result(response)
    return parsed_response
